{"version":3,"sources":["../src/index.test.js"],"names":["test","require","td","bunnyhop","after","reset","cb","t","plan","errorHandler","function","listenError","Error","subscribeError","bh","onHandlerError","engine","Engines","LocalEngine","connectionManager","ConnectionManager","listen","subscribe","send","sync","then","verify","pass","publish","setImmediate","end","successHandler","onHandlerSuccess","isListenExample","content","isPublishExample"],"mappings":";;AAAA;;;;AAIA,MAAMA,OAAOC,QAAQ,KAAR,CAAb;AACA,MAAMC,KAAKD,QAAQ,YAAR,CAAX;;AAEA,MAAME,WAAWF,QAAQ,SAAR,CAAjB;;AAEAD,KAAKI,KAAL,CAAW,MAAM;AACfF,KAAGG,KAAH;AACD,CAFD;;AAIAL,KAAKM,EAAL,CAAQ,0BAAR,EAAoCC,KAAK;AACvCA,IAAEC,IAAF,CAAO,CAAP;AACA,QAAMC,eAAeP,GAAGQ,QAAH,EAArB;AACA,QAAMC,cAAc,IAAIC,KAAJ,CAAU,cAAV,CAApB;AACA,QAAMC,iBAAiB,IAAID,KAAJ,CAAU,iBAAV,CAAvB;;AAEA,QAAME,KAAKX,SAAS,sBAAT,EAAiC;AAC1CY,oBAAgBN,YAD0B;AAE1CO,YAAQb,SAASc,OAAT,CAAiBC,WAFiB;AAG1CC,uBAAmBhB,SAASc,OAAT,CAAiBC,WAAjB,CAA6BE;AAHN,GAAjC,CAAX;;AAMAN,KAAGO,MAAH,CAAU,gBAAV,EAA4B,MAAM;AAAE,UAAMV,WAAN;AAAoB,GAAxD;AACAG,KAAGQ,SAAH,CAAa,mBAAb,EAAkC,MAAM;AAAE,UAAMT,cAAN;AAAuB,GAAjE;;AAEA;AACAC,KAAGS,IAAH,CAAQ,gBAAR,EAA0B,EAA1B,EAA8B,EAAEC,MAAM,IAAR,EAA9B,EAA8CC,IAA9C,CAAmD,MAAM;AACvDvB,OAAGwB,MAAH,CAAUjB,aAAaE,WAAb,CAAV;AACAJ,MAAEoB,IAAF;AACD,GAHD;;AAKAb,KAAGc,OAAH,CAAW,mBAAX,EAAgC,EAAhC;AACA;AACAC,eAAa,MAAM;AACjB3B,OAAGwB,MAAH,CAAUjB,aAAaI,cAAb,CAAV;AACAN,MAAEoB,IAAF;AACApB,MAAEuB,GAAF;AACD,GAJD;AAKD,CA5BD;;AA8BA9B,KAAKM,EAAL,CAAQ,4BAAR,EAAsCC,KAAK;AACzCA,IAAEC,IAAF,CAAO,CAAP;AACA,QAAMuB,iBAAiB7B,GAAGQ,QAAH,EAAvB;;AAEA,QAAMI,KAAKX,SAAS,wBAAT,EAAmC;AAC5C6B,sBAAkBD,cAD0B;AAE5Cf,YAAQb,SAASc,OAAT,CAAiBC,WAFmB;AAG5CC,uBAAmBhB,SAASc,OAAT,CAAiBC,WAAjB,CAA6BE;AAHJ,GAAnC,CAAX;;AAMAN,KAAGO,MAAH,CAAU,gBAAV,EAA4B,MAAM;AAAE,WAAO,CAAP;AAAW,GAA/C;AACAP,KAAGQ,SAAH,CAAa,mBAAb,EAAkC,MAAM;AAAE,WAAO,CAAP;AAAW,GAArD;;AAEA;AACAR,KAAGS,IAAH,CAAQ,gBAAR,EAA0B,EAAEU,iBAAiB,IAAnB,EAA1B,EAAqD,EAAET,MAAM,IAAR,EAArD,EAAqEC,IAArE,CAA0E,MAAM;AAC9EvB,OAAGwB,MAAH,CAAUK,eAAe,CAAf,EAAkB,EAAEG,SAAS,EAAED,iBAAiB,IAAnB,EAAX,EAAlB,CAAV;AACA1B,MAAEoB,IAAF;AACD,GAHD;;AAKAb,KAAGc,OAAH,CAAW,mBAAX,EAAgC,EAAEO,kBAAkB,IAApB,EAAhC;AACA;AACAN,eAAa,MAAM;AACjB3B,OAAGwB,MAAH,CAAUK,eAAe,CAAf,EAAkB,EAAEG,SAAS,EAAEC,kBAAkB,IAApB,EAAX,EAAlB,CAAV;AACA5B,MAAEoB,IAAF;AACApB,MAAEuB,GAAF;AACD,GAJD;AAKD,CA1BD","file":"index.test.js","sourcesContent":["/**\n * Created by balmasi on 2017-06-09.\n */\n\nconst test = require('ava');\nconst td = require('testdouble');\n\nconst bunnyhop = require('./index');\n\ntest.after(() => {\n  td.reset();\n});\n\ntest.cb('Options - onHandlerError', t => {\n  t.plan(2);\n  const errorHandler = td.function();\n  const listenError = new Error('Listen Error');\n  const subscribeError = new Error('Subscribe Error');\n\n  const bh = bunnyhop('ErrorHandlingService', {\n    onHandlerError: errorHandler,\n    engine: bunnyhop.Engines.LocalEngine,\n    connectionManager: bunnyhop.Engines.LocalEngine.ConnectionManager\n  });\n\n  bh.listen('Options.Listen', () => { throw listenError; });\n  bh.subscribe('Options.Subscribe', () => { throw subscribeError; });\n\n  // try {\n  bh.send('Options.Listen', {}, { sync: true }).then(() => {\n    td.verify(errorHandler(listenError));\n    t.pass();\n  });\n\n  bh.publish('Options.Subscribe', {});\n  // Publishes cannot be synchronous so we wait for error to propagate as side effect\n  setImmediate(() => {\n    td.verify(errorHandler(subscribeError));\n    t.pass();\n    t.end();\n  })\n});\n\ntest.cb('Options - onHandlerSuccess', t => {\n  t.plan(2);\n  const successHandler = td.function();\n\n  const bh = bunnyhop('SuccessHandlingService', {\n    onHandlerSuccess: successHandler,\n    engine: bunnyhop.Engines.LocalEngine,\n    connectionManager: bunnyhop.Engines.LocalEngine.ConnectionManager\n  });\n\n  bh.listen('Options.Listen', () => { return 2; });\n  bh.subscribe('Options.Subscribe', () => { return 3; });\n\n  // try {\n  bh.send('Options.Listen', { isListenExample: true }, { sync: true }).then(() => {\n    td.verify(successHandler(2, { content: { isListenExample: true } }));\n    t.pass();\n  });\n\n  bh.publish('Options.Subscribe', { isPublishExample: true });\n  // Publishes cannot be synchronous so we wait for error to propagate as side effect\n  setImmediate(() => {\n    td.verify(successHandler(3, { content: { isPublishExample: true } }));\n    t.pass();\n    t.end();\n  })\n});"]}